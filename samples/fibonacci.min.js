$(function(){let t=.5*(1+Math.sqrt(5)),a=800,r=a/t,e=.85,n=600,i=2,c=2,s=1,o=1,h=d3.select('#container_fibonacci').append('svg').attr('width',a).attr('height',a).attr("xmlns","http://www.w3.org/2000/svg");h.append('rect').attr('class','background').attr('x',0).attr('y',0).attr('width',a).attr('height',a);let d=a*e/s,p="scale("+d+","+d+")",l=h.append('g').attr('transform',p);function w(){h.append('path').attr('d','M 0 0 l '+a+' '+r);h.append('path').attr('d','M 0 0 l '+r+' '+a);let t=s,e=o,n=i/d;l.append('rect').attr('stroke-width',n).attr('x',0).attr('y',0).attr('width',t).attr('height',e);g()}w();function f(){let t=a*e/s,r="scale("+t+","+t+")";l.transition().duration(n).attrTween('transform',function(t,a){let e=this.getAttribute("transform");return d3.interpolateTransformSvg(e,r)});
	l.selectAll('rect').transition().duration(n).attr('stroke-width',i/t);
	return t}function u(){let t=s+o;o=s;s=t;c+=1;let a,r;c%2==1?(a=s,r=o):(a=o,r=s);let e=f();l.append('rect').attr('id','fib'+c).attr('stroke-width',i/e).attr('x',0).attr('y',0).attr('width',a).attr('height',r);g()}function g(){let t=c+':'+s+' - '+(c-1)+':'+o,a=o,r=s-o,e=c-2;while(e>=1&&c-e<=8){let n=a-r,i=" - "+e+":"+r;a=r;r=n;t+=i;e-=1}console.log("c",e);e>=1&&(t+=' ...');$('#display').html(t)}function b(){if(c==2)return;let t=s-o;s=o;o=t;l.select("#fib"+c).remove();c-=1;f();g()}function k(t){t.which!=0?u():b()}function m(t){switch(t.which){case 40:;case 39:;case 34:u();t.preventDefault();break;case 8:;case 37:;case 38:;case 33:b();t.preventDefault();break}}$("#next").click(u);$("#display").click(u);$("#back").click(b);$("body").keypress(k);$("body").keydown(m)})